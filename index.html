<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>こんどうかずきの部屋</title>
  <meta name="description" content="近藤航樹（こんどうかずき）の個人サイト。東京農工大学大学院連合農学研究科の博士学生。土壌侵食に関する研究に取り組んでいます。" />

  <!-- OGP -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="こんどうかずきの部屋" />
  <meta property="og:description" content="" />
  <meta property="og:locale" content="ja_JP" />
  <!-- 画像を用意したら有効化（例: /assets/ogp.png） -->
  <!-- <meta property="og:image" content="https://YOUR_DOMAIN/assets/ogp.png" /> -->

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <!-- <meta name="twitter:image" content="https://YOUR_DOMAIN/assets/ogp.png" /> -->

  <!-- canonical（独自ドメインやGitHub PagesのURLが確定したら入れる） -->
  <!-- <link rel="canonical" href="https://YOUR_DOMAIN/" /> -->

  <link rel="stylesheet" href="css/style.css" />
  <!-- favicon（用意したら） -->
  <!-- <link rel="icon" href="/favicon.ico" /> -->

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6DTS5ZTWHJ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-6DTS5ZTWHJ');
  </script>
</head>

<body>
  <nav class="nav" aria-label="サイト内ナビゲーション">
    <a href="index.html" aria-current="page">Home</a>
    <a href="cv.html">経歴</a>
    <a href="publications.html">業績</a>
    <a href="notes/">ブログ風</a>
    <a href="other.html">その他</a>
  </nav>

  <header class="header">
    <h1>こんどうかずきの部屋</h1>
    <p>
      近藤航樹（こんどうかずき）です。<br />
      東京農工大学大学院連合農学研究科の博士学生です。<br />
      主に土壌侵食の研究をしています。
    </p>
  </header>

  <main class="container">
    <section class="card">
      <h2>研究紹介</h2>

      <p>
        私の研究では、土壌侵食解析モデル
        <strong>WEPP (Water Erosion Prediction Project)</strong>
        を用いて、降雨特性や気候変動が土壌侵食に与える影響を評価しています。
      </p>

      <p>
        特に、
        <strong>雨滴の運動エネルギー</strong>や
        <strong>気候変動に伴う降水現象の将来変化</strong>に着目し、
        日本全国の観測データや将来気候データを組み合わせた解析手法の構築に取り組んでいます。
      </p>

      <p>
        農業工学という学問の枠にとらわれず、気象学や気候科学などの知見も生かした
        <strong>学際的な研究</strong>に挑戦しています。
      </p>

      <p class="sub">
        使用モデルはこちら：
        <a
          href="https://www.ars.usda.gov/midwest-area/west-lafayette-in/national-soil-erosion-research/docs/wepp/"
          target="_blank"
          rel="noopener"
          referrerpolicy="no-referrer"
        >
          WEPP (USDA-ARS)
        </a>
      </p>

      <p class="sub">
        ※その他の解析環境・データ・ライブラリについては
        <a href="other.html">その他</a>
        のページにまとめています。
      </p>
    </section>

    <section class="card">
      <h2>最新の投稿（ブログ風）</h2>
      <div id="latest-posts">
        <p class="sub">読み込み中…</p>
      </div>
      <noscript>
        <p class="sub">JavaScriptが無効のため、最新記事を表示できません。<a href="notes/">ブログ風</a>からご覧ください。</p>
      </noscript>
    </section>
  </main>

  <footer class="footer">© 2026</footer>

  <script>
    // HTMLを直挿ししない（簡易サニタイズ寄り）
    function createPostItem(p) {
      const article = document.createElement("article");
      article.className = "post-item";

      const h3 = document.createElement("h3");
      h3.className = "post-title";

      const a = document.createElement("a");
      a.href = p.url;
      a.textContent = p.title || "(no title)";
      h3.appendChild(a);

      const meta = document.createElement("p");
      meta.className = "sub";
      meta.textContent = p.date || "";

      article.appendChild(h3);
      article.appendChild(meta);

      if (p.excerpt) {
        const ex = document.createElement("p");
        ex.className = "post-excerpt";
        ex.textContent = p.excerpt;
        article.appendChild(ex);
      }

      return article;
    }

    function toTime(dateStr) {
      // "YYYY-MM-DD" 想定。崩れててもNaNにならない程度に扱う
      const t = Date.parse(dateStr);
      return Number.isFinite(t) ? t : 0;
    }

    (async () => {
      const box = document.getElementById("latest-posts");
      try {
        const res = await fetch("notes/posts.json", { cache: "no-store" });
        if (!res.ok) throw new Error("posts.json not found");

        const posts = await res.json();
        if (!Array.isArray(posts)) throw new Error("posts.json format invalid");

        // 日付降順にソートして上位3つ
        posts.sort((a, b) => toTime(b.date) - toTime(a.date));
        const latest = posts.slice(0, 3);

        box.innerHTML = "";
        if (latest.length === 0) {
          const p = document.createElement("p");
          p.className = "sub";
          p.textContent = "まだ記事がありません。";
          box.appendChild(p);
          return;
        }

        latest.forEach(p => box.appendChild(createPostItem(p)));
      } catch (e) {
        box.innerHTML = "";
        const p = document.createElement("p");
        p.className = "sub";
        p.textContent = "最新記事の読み込みに失敗しました（posts.json を確認してください）。";
        box.appendChild(p);
      }
    })();
  </script>
</body>
</html>

